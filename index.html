<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Middlemarch: The Paths Not Taken</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      --parchment: #f4ebe1;
      --ink: #2c1810;
      --sepia: #8b7355;
      --gold: #c9a961;
      --burgundy: #6d2932;
      --sage: #7a8b72;
      --shadow: rgba(44, 24, 16, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'EB Garamond', serif;
      background: linear-gradient(135deg, #f4ebe1 0%, #e8dcc8 100%);
      color: var(--ink);
      line-height: 1.6;
      min-height: 100vh;
    }

    .game-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .header {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
      padding: 2rem 0;
    }

    .header::before,
    .header::after {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
    }

    .header::before {
      top: 0;
    }

    .header::after {
      bottom: 0;
    }

    h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 3.5rem;
      font-weight: 700;
      color: var(--burgundy);
      margin-bottom: 0.5rem;
      text-shadow: 2px 2px 4px var(--shadow);
      letter-spacing: 0.05em;
    }

    .subtitle {
      font-size: 1.3rem;
      color: var(--sepia);
      font-style: italic;
      font-weight: 400;
    }

    .mode-selector {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      margin-bottom: 3rem;
    }

    .mode-btn {
      padding: 1rem 2.5rem;
      border: 2px solid var(--sepia);
      background: var(--parchment);
      font-family: 'EB Garamond', serif;
      font-size: 1.1rem;
      color: var(--ink);
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 4px;
      box-shadow: 0 4px 6px var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .mode-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(201, 169, 97, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .mode-btn:hover::before {
      left: 100%;
    }

    .mode-btn:hover {
      border-color: var(--gold);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px var(--shadow);
    }

    .mode-btn.active {
      background: var(--burgundy);
      color: var(--parchment);
      border-color: var(--burgundy);
    }

    .storyline-selector {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-bottom: 3rem;
    }

    .storyline-card {
      background: white;
      border: 3px solid var(--sepia);
      border-radius: 8px;
      padding: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .storyline-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--gold);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .storyline-card:hover::before,
    .storyline-card.active::before {
      transform: scaleX(1);
    }

    .storyline-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px var(--shadow);
      border-color: var(--gold);
    }

    .storyline-card.active {
      background: linear-gradient(135deg, #fff9f0 0%, #ffffff 100%);
      border-color: var(--burgundy);
    }

    .storyline-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--burgundy);
      margin-bottom: 0.5rem;
    }

    .storyline-desc {
      font-size: 1rem;
      color: var(--sepia);
      line-height: 1.5;
    }

    .decision-container {
      background: white;
      border: 3px solid var(--sepia);
      border-radius: 8px;
      padding: 2.5rem;
      box-shadow: 0 8px 16px var(--shadow);
      margin-bottom: 2rem;
      position: relative;
    }

    .decision-container::before {
      content: '‚ù¶';
      position: absolute;
      top: -1.5rem;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      color: var(--gold);
      background: white;
      padding: 0 1rem;
    }

    .chapter-label {
      display: inline-block;
      background: var(--burgundy);
      color: var(--parchment);
      padding: 0.4rem 1rem;
      border-radius: 4px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .decision-question {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem;
      font-weight: 600;
      color: var(--burgundy);
      margin-bottom: 1.5rem;
      line-height: 1.3;
    }

    .decision-context {
      font-size: 1.1rem;
      color: var(--ink);
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: var(--parchment);
      border-left: 4px solid var(--gold);
      border-radius: 4px;
      font-style: italic;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .choice-btn {
      padding: 1.5rem;
      border: 2px solid var(--sepia);
      background: white;
      font-family: 'EB Garamond', serif;
      font-size: 1.2rem;
      color: var(--ink);
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 6px;
      text-align: left;
      position: relative;
      overflow: hidden;
    }

    .choice-btn::before {
      content: '‚Üí';
      position: absolute;
      left: -30px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      color: var(--gold);
      transition: left 0.3s ease;
    }

    .choice-btn:hover::before {
      left: 1rem;
    }

    .choice-btn:hover {
      background: linear-gradient(135deg, #fff9f0 0%, #ffffff 100%);
      border-color: var(--gold);
      transform: translateX(8px);
      padding-left: 3rem;
    }

    .choice-btn.canonical {
      border-left: 4px solid var(--sage);
    }

    .progress-bar {
      background: var(--parchment);
      border: 2px solid var(--sepia);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 2rem;
    }

    .progress-track {
      height: 8px;
      background: rgba(139, 115, 85, 0.2);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--burgundy), var(--gold));
      transition: width 0.5s ease;
      border-radius: 4px;
    }

    .score-display {
      text-align: center;
      margin-top: 1rem;
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.3rem;
      color: var(--burgundy);
    }

    .reveal-btn {
      margin-top: 1.5rem;
      padding: 1rem 2rem;
      background: var(--sage);
      color: white;
      border: none;
      border-radius: 6px;
      font-family: 'EB Garamond', serif;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px var(--shadow);
    }

    .reveal-btn:hover {
      background: var(--burgundy);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px var(--shadow);
    }

    .canonical-reveal {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f0f9f0 0%, #ffffff 100%);
      border: 2px solid var(--sage);
      border-radius: 6px;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .canonical-label {
      font-weight: 600;
      color: var(--sage);
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }

    .consequence-text {
      color: var(--ink);
      font-size: 1.05rem;
      line-height: 1.6;
    }

    .finale {
      background: white;
      border: 3px solid var(--gold);
      border-radius: 8px;
      padding: 3rem;
      box-shadow: 0 12px 24px var(--shadow);
      text-align: center;
    }

    .finale h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2.5rem;
      color: var(--burgundy);
      margin-bottom: 2rem;
    }

    .finale-text {
      font-size: 1.2rem;
      color: var(--ink);
      line-height: 1.8;
      margin-bottom: 2rem;
    }

    .restart-btn {
      padding: 1.2rem 3rem;
      background: var(--burgundy);
      color: var(--parchment);
      border: none;
      border-radius: 6px;
      font-family: 'EB Garamond', serif;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px var(--shadow);
    }

    .restart-btn:hover {
      background: var(--gold);
      color: var(--ink);
      transform: scale(1.05);
      box-shadow: 0 6px 12px var(--shadow);
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 2.5rem;
      }

      .subtitle {
        font-size: 1.1rem;
      }

      .mode-selector {
        flex-direction: column;
        align-items: stretch;
      }

      .storyline-selector {
        grid-template-columns: 1fr;
      }

      .decision-question {
        font-size: 1.5rem;
      }
    }

    .ornament {
      text-align: center;
      color: var(--gold);
      font-size: 1.5rem;
      margin: 2rem 0;
      opacity: 0.6;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Load decision tree data
    const DECISION_DATA = null; // Will be loaded from JSON file

    function MiddlemarchGame() {
      const [gameMode, setGameMode] = useState(null); // 'quiz' or 'explore'
      const [selectedStoryline, setSelectedStoryline] = useState(null);
      const [currentDecisionIndex, setCurrentDecisionIndex] = useState(0);
      const [decisions, setDecisions] = useState([]);
      const [score, setScore] = useState(0);
      const [showCanonical, setShowCanonical] = useState(false);
      const [pathHistory, setPathHistory] = useState([]);
      const [isComplete, setIsComplete] = useState(false);

      useEffect(() => {
        // Load decision tree - in production, fetch from JSON file
        // For now, we'll simulate with placeholder
        loadDecisions();
      }, [selectedStoryline]);

      const loadDecisions = () => {
        if (!selectedStoryline) return;
        
        // Filter decisions by storyline
        // This is placeholder - will load from actual JSON
        const storylineDecisions = [
          // Placeholder structure
        ];
        
        setDecisions(storylineDecisions);
      };

      const handleModeSelect = (mode) => {
        setGameMode(mode);
      };

      const handleStorylineSelect = (storyline) => {
        setSelectedStoryline(storyline);
        setCurrentDecisionIndex(0);
        setScore(0);
        setPathHistory([]);
        setIsComplete(false);
      };

      const handleChoice = (choice, isCanonical) => {
        const currentDecision = decisions[currentDecisionIndex];
        
        // Record choice in history
        setPathHistory([...pathHistory, {
          decision: currentDecision,
          choice: choice,
          isCanonical: isCanonical
        }]);

        // Update score in quiz mode
        if (gameMode === 'quiz' && isCanonical) {
          setScore(score + 10);
        }

        // Move to next decision
        if (currentDecisionIndex < decisions.length - 1) {
          setCurrentDecisionIndex(currentDecisionIndex + 1);
          setShowCanonical(false);
        } else {
          setIsComplete(true);
        }
      };

      const handleRestart = () => {
        setGameMode(null);
        setSelectedStoryline(null);
        setCurrentDecisionIndex(0);
        setScore(0);
        setPathHistory([]);
        setIsComplete(false);
      };

      // Landing page
      if (!gameMode) {
        return (
          <div className="game-container">
            <div className="header">
              <h1>Middlemarch</h1>
              <div className="subtitle">The Paths Not Taken</div>
            </div>

            <div className="ornament">‚ù¶ ‚ù¶ ‚ù¶</div>

            <div style={{textAlign: 'center', maxWidth: '700px', margin: '0 auto 3rem', fontSize: '1.2rem', color: 'var(--sepia)'}}>
              <p style={{marginBottom: '1rem'}}>
                "For the growing good of the world is partly dependent on unhistoric acts; 
                and that things are not so ill with you and me as they might have been, 
                is half owing to the number who lived faithfully a hidden life."
              </p>
              <p style={{fontStyle: 'italic', fontSize: '1rem'}}>‚Äî George Eliot, <em>Middlemarch</em></p>
            </div>

            <div style={{textAlign: 'center', maxWidth: '600px', margin: '0 auto 3rem', color: 'var(--ink)'}}>
              <p>
                Explore the cascading choices that shaped the lives of Dorothea Brooke, 
                Tertius Lydgate, and Fred Vincy. Witness their mistakes, their growth, 
                and discover the paths they might have taken.
              </p>
            </div>

            <div className="ornament">‚ù¶</div>

            <div className="mode-selector">
              <button className="mode-btn" onClick={() => handleModeSelect('quiz')}>
                <div style={{fontWeight: 600, marginBottom: '0.3rem'}}>Quiz Mode</div>
                <div style={{fontSize: '0.95rem', opacity: 0.8}}>
                  Test your knowledge of the novel's canonical path
                </div>
              </button>
              <button className="mode-btn" onClick={() => handleModeSelect('explore')}>
                <div style={{fontWeight: 600, marginBottom: '0.3rem'}}>Exploration Mode</div>
                <div style={{fontSize: '0.95rem', opacity: 0.8}}>
                  Create alternative narratives and see what might have been
                </div>
              </button>
            </div>
          </div>
        );
      }

      // Storyline selection
      if (!selectedStoryline) {
        return (
          <div className="game-container">
            <div className="header">
              <h1>Choose Your Story</h1>
              <div className="subtitle">
                {gameMode === 'quiz' ? 'Quiz Mode' : 'Exploration Mode'}
              </div>
            </div>

            <div className="storyline-selector">
              <div className="storyline-card" onClick={() => handleStorylineSelect('dorothea')}>
                <div className="storyline-title">Dorothea's Journey</div>
                <div className="storyline-desc">
                  From idealistic Miss Brooke to her disastrous marriage with Casaubon, 
                  through disillusionment and friendship with Lydgate, to choosing love 
                  with Will Ladislaw over wealth and respectability.
                </div>
                <div style={{marginTop: '1rem', color: 'var(--sepia)', fontSize: '0.9rem'}}>
                  17 decisions ‚Ä¢ Redemption through love
                </div>
              </div>

              <div className="storyline-card" onClick={() => handleStorylineSelect('lydgate')}>
                <div className="storyline-title">Lydgate's Decline</div>
                <div className="storyline-desc">
                  An ambitious young doctor trapped by desire, pride, and circumstance. 
                  Watch his dreams crumble through a cascade of errors, saved only 
                  partially by Dorothea's friendship.
                </div>
                <div style={{marginTop: '1rem', color: 'var(--sepia)', fontSize: '0.9rem'}}>
                  15 decisions ‚Ä¢ Tragic fall
                </div>
              </div>

              <div className="storyline-card" onClick={() => handleStorylineSelect('fred')}>
                <div className="storyline-title">Fred's Redemption</div>
                <div className="storyline-desc">
                  From idle heir expecting Featherstone's fortune to honest worker 
                  learning from Caleb Garth. Earning Mary's love through character growth 
                  and finding his true vocation.
                </div>
                <div style={{marginTop: '1rem', color: 'var(--sepia)', fontSize: '0.9rem'}}>
                  12 decisions ‚Ä¢ Earned happiness
                </div>
              </div>
            </div>

            <div style={{textAlign: 'center', marginTop: '2rem'}}>
              <button className="reveal-btn" onClick={() => setGameMode(null)}>
                ‚Üê Change Mode
              </button>
            </div>
          </div>
        );
      }

      // Game complete
      if (isComplete) {
        const totalDecisions = decisions.length;
        const percentage = gameMode === 'quiz' ? Math.round((score / (totalDecisions * 10)) * 100) : null;

        return (
          <div className="game-container">
            <div className="finale">
              <h2>Your Journey Complete</h2>
              
              {gameMode === 'quiz' && (
                <div style={{marginBottom: '2rem'}}>
                  <div style={{fontSize: '3rem', color: 'var(--gold)', marginBottom: '1rem'}}>
                    {score} / {totalDecisions * 10}
                  </div>
                  <div style={{fontSize: '1.3rem', color: 'var(--burgundy)'}}>
                    {percentage}% Canonical Accuracy
                  </div>
                </div>
              )}

              <div className="finale-text">
                {selectedStoryline === 'dorothea' && (
                  <p>
                    You've witnessed Dorothea's journey from idealistic youth through disillusionment 
                    to her final choice: love and purpose over wealth and social position. 
                    {gameMode === 'explore' && ' Your alternative path reveals new possibilities in her story.'}
                  </p>
                )}
                {selectedStoryline === 'lydgate' && (
                  <p>
                    You've followed Lydgate's tragic descent from ambitious reformer to compromised physician. 
                    His cascade of errors shows how pride, desire, and circumstance can destroy even the talented.
                    {gameMode === 'explore' && ' But what if different choices had been made?'}
                  </p>
                )}
                {selectedStoryline === 'fred' && (
                  <p>
                    You've seen Fred's transformation from idle heir to honest worker. 
                    Through shame, guidance from Caleb Garth, and Mary's love, he found his vocation.
                    {gameMode === 'explore' && ' Your alternative path explores different routes to redemption.'}
                  </p>
                )}
              </div>

              <div className="ornament">‚ù¶ ‚ù¶ ‚ù¶</div>

              <div style={{display: 'flex', gap: '1rem', justifyContent: 'center', marginTop: '2rem'}}>
                <button className="restart-btn" onClick={handleRestart}>
                  Play Another Story
                </button>
                <button className="restart-btn" onClick={() => {
                  setCurrentDecisionIndex(0);
                  setScore(0);
                  setPathHistory([]);
                  setIsComplete(false);
                }}>
                  Replay This Story
                </button>
              </div>
            </div>
          </div>
        );
      }

      // Placeholder for actual game play
      // This will be filled with real decision data
      return (
        <div className="game-container">
          <div className="header">
            <h1>
              {selectedStoryline === 'dorothea' && "Dorothea's Journey"}
              {selectedStoryline === 'lydgate' && "Lydgate's Decline"}
              {selectedStoryline === 'fred' && "Fred's Redemption"}
            </h1>
            <div className="subtitle">
              {gameMode === 'quiz' ? 'Quiz Mode' : 'Exploration Mode'}
            </div>
          </div>

          {gameMode === 'quiz' && (
            <div className="progress-bar">
              <div className="progress-track">
                <div 
                  className="progress-fill" 
                  style={{width: `${((currentDecisionIndex + 1) / decisions.length) * 100}%`}}
                />
              </div>
              <div className="score-display">
                Score: {score} points ‚Ä¢ Decision {currentDecisionIndex + 1} of {decisions.length}
              </div>
            </div>
          )}

          <div className="decision-container">
            <div className="chapter-label">Chapter [X] ‚Ä¢ [Location]</div>
            <div className="decision-question">
              Will [Character] [make a decision]?
            </div>
            <div className="decision-context">
              [Context about the decision and its implications]
            </div>
            
            <div className="choices">
              <button className="choice-btn canonical" onClick={() => handleChoice('yes', true)}>
                <strong>Yes</strong> ‚Äî [Consequence text]
              </button>
              <button className="choice-btn" onClick={() => handleChoice('no', false)}>
                <strong>No</strong> ‚Äî [Alternative path]
              </button>
            </div>

            {gameMode === 'explore' && !showCanonical && (
              <button className="reveal-btn" onClick={() => setShowCanonical(true)}>
                üìñ Reveal What Actually Happened
              </button>
            )}

            {showCanonical && (
              <div className="canonical-reveal">
                <div className="canonical-label">‚úì In the novel, Eliot writes:</div>
                <div className="consequence-text">
                  [Canonical consequence from the actual novel]
                </div>
              </div>
            )}
          </div>

          <div style={{textAlign: 'center'}}>
            <button className="reveal-btn" onClick={() => setSelectedStoryline(null)}>
              ‚Üê Choose Different Story
            </button>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<MiddlemarchGame />);
  </script>
</body>
</html>
